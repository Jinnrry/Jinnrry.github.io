---
layout:     post
title:      "ubuntu16.04下编译安装caffe"
subtitle:   "caffe最简单的安装方式"
date:       2017-1-2 11:00:00
author:     "蒋为"
header-img: "img/18.jpg"
catalog: true
tags:
    - Caffe
---
>记录


## caffe简介

Caffe是一个清晰而高效的深度学习框架，其作者是毕业于UC Berkeley的贾扬清博士，目前在Google工作。

Caffe是纯粹的C++/CUDA架构，支持命令行、Python和MATLAB接口；可以在CPU和GPU直接无缝切换：

本文介绍的是仅cpu模式编译安装caffe，是我看过几十篇文章后总结的最简单的安装方式，但是运行效率不怎么样，不过对于刚入门的初学者学习caffe差不多够了，

可以少花一点时间在配置上面。



## caffe安装

### 安装依赖项

{% highlight pl %}

sudo apt-get install git libprotobuf-dev libleveldb-dev libsnappy-dev libopencv-dev libhdf5-serial-dev protobuf-compiler

sudo apt-get install --no-install-recommends libboost-all-dev libatlas-base-dev python-dev libgflags-dev libgoogle-glog-dev liblmdb-dev

{% endhighlight %}






### 下载与配置文件

{% highlight pl %}

git clone https://github.com/BVLC/caffe



cp Makefile.config.example Makefile.config  //生成配置文件

gedit Makefile.config   //修改配置文件

{% endhighlight %}


修改CPU_ONLY=1，将前面的#号删除即可。

将# Whatever else you find you need goes here.下面两项修改为：
INCLUDE_DIRS := $(PYTHON_INCLUDE) /usr/local/include /usr/include/hdf5/serial 
LIBRARY_DIRS := $(PYTHON_LIB) /usr/local/lib /usr/lib /usr/lib/x86_64-linux-gnu /usr/lib/x86_64-linux-gnu/hdf5/serial
这是因为Ubuntu16.04的路径发生了一些变化

打开makefile文件搜索并替换
NVCCFLAGS += -ccbin=$(CXX) -Xcompiler -fPIC $(COMMON_FLAGS)
为
NVCCFLAGS += -D_FORCE_INLINES -ccbin=$(CXX) -Xcompiler -fPIC $(COMMON_FLAGS)




### 编译

{% highlight pl %}
make all -j8

make test

make runtest


{% endhighlight %}

关于j8：
j8是编译器选项，代表计算机cpu有8个核，因此可以多线程一起make，这样make的速度会快很多。一般常用的还有j4




## 安装anaconda并配置python接口

　　anaconda官网上有免费下载地址和安装指令，灰常滴简单。https://www.continuum.io/downloads

　　更改环境变量。

　　sudo gedit /etc/profile
  
   添加如下3行：
  

　　export PATH=/home/irondroid/anaconda2/bin:$PATH

　　export PYTHONPATH=/home/irondroid/caffe/python:$PYTHONPATH

　　export LD_PRELOAD=/usr/lib/x86_64-linux-gnu/libstdc++.so.6
  
  
   然后：
	
　　source /etc/profile

　　cd caffe

　　make pycaffe



## 完成caffe安装

　　重启电脑后输入python，如果出现anaconda路径那就说明anaconda安装成功啦。然后

　　>>>import caffe

　　如果出现protobuf之类的什么错误

　　sudo chmod 777 -R anaconda2

　　conda install protobuf

　　这样既可

　　然后再

　　>>>import caffe

　　>>>

　　证明安装成功。



## 最后，关于配置cuda和cudd提高caffe速度

   有兴趣可以去折腾下，反正我折腾了几天都没成功  T——T




## 主要参考文章

http://www.cnblogs.com/------------/p/6070324.html
